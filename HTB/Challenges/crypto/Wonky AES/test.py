from itertools import product
from random import randint, random
from Crypto.Cipher import AES
import lib
from icecream import ic

possible_lrnd_keys_all = [
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 113, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 83, 34, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 113, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 41, 30, 34, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 113, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 83, 34, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 113, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 106, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 18, 198, 46, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 227, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 227, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 227, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 227, 198, 69, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 46, 198, 91, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 46, 198, 91, 52, 234, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 46, 198, 69, 52, 224, 176],
    [193, 81, 126, 63, 30, 34, 191, 104, 95, 198, 46, 198, 69, 52, 234, 176],
]


flag_enc = bytes.fromhex('325c0b76326e855ae543fe28ef62eac3fea614909559cf38cc56e73da3ae2de5')

for last_rk in possible_lrnd_keys_all:
    aes_key = lib.get_key_from_last_rk(last_rk)
    aes = AES.new(aes_key, mode=AES.MODE_ECB)
    pt = aes.decrypt(flag_enc)
    if pt.startswith(b'HTB{'):
        print(pt.decode())
        break



def expand_key(master_key):
    """
    Expands and returns a list of key matrices for the given master_key.
    """
    # Initialize round keys with raw key material.
    key_columns = [[c for c in master_key[i*4:(i+1)*4]] for i in range(4)]
    iteration_size = 4

    i = 1
    while len(key_columns) < (11) * 4:
        # Copy previous word.
        word = list(key_columns[-1])

        # Perform schedule_core once every "row".
        if len(key_columns) % iteration_size == 0:
            # Circular shift.
            word.append(word.pop(0))
            # Map to S-BOX.
            word = [lib.sbox[b] for b in word]
            # XOR with first byte of R-CON, since the others bytes of R-CON are 0.
            word[0] ^= lib.rcon[i]
            i += 1

        # XOR with equivalent word from previous iteration.
        word = [i^j for i,j in zip(word, key_columns[-iteration_size])]
        key_columns.append(word)

    # Group key words in 4x4 byte matrices.
    # return [key_columns[4*i : 4*(i+1)] for i in range(len(key_columns) // 4)]
    result = [[] for _ in range(11)]
    for i in range(len(result)):
        for j in range(4):
            result[i] += key_columns[i*4+j]
    return result


round_keys = expand_key(b'\x00'*16)
ic([hex(x)[2:] for x in round_keys[-1]])

rks_test = lib.get_key_from_last_rk(round_keys[-1])
ic(rks_test)


x_vect = [randint(0,255) for _ in range(4)]
ic(x_vect)
fault = [randint(0,255), 0, 0, 0]
ic(fault)
fault_mix = fault.copy()
lib.mix_single_column(fault_mix)
ic(fault_mix)

r11 = [round_keys[-1][i*4] for i in range(4)]

ctc = [r11[i] ^ lib.sbox[x_vect[i]] for i in range(4)]
ctf = [r11[i] ^ lib.sbox[x_vect[i] ^ fault_mix[i]] for i in range(4)]
ctx = [i^j for i,j in zip(ctc, ctf)]

x_vect_test = [lib.inv_sbox[r11[i] ^ ctc[i]] for i in range(4)]
ic(x_vect_test)
fault_vect = [x_vect[i] ^ lib.inv_sbox[lib.sbox[x_vect[i]] ^ ctx[i]] for i in range(4)]
ic(fault_vect)
lib.inv_single_column(fault_vect)
ic(fault_vect)
